<!DOCTYPE html>
<html lang="ht">
<head>
  <meta charset="UTF-8">
  <title>Rebel Mode | Estatistik Vant</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family:Poppins,sans-serif; background:#0f0f0f; color:#fff; margin:0; padding:0; }
    header { background:#1e1e1e; padding:20px 40px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 2px 10px rgba(255,255,255,0.1);}
    header h1 { color:#ffcc00; }
    main { padding:40px; max-width:1100px; margin:auto; }
    .stats { display:flex; gap:20px; flex-wrap:wrap; margin-bottom:40px; }
    .card { background:#1a1a1a; padding:20px; border-radius:10px; flex:1 1 200px; text-align:center; box-shadow:0 2px 8px rgba(0,0,0,0.4); }
    .card h2 { font-size:24px; margin:0; color:#ffcc00; }
    .card p { font-size:18px; margin:5px 0 0 0; }
    canvas { background:#1a1a1a; border-radius:10px; padding:20px; }
    button { background:#ffcc00; color:#000; padding:10px 20px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; margin-top:20px;}
    button:hover { background:#ffdd33; }
  </style>
</head>
<body>
  <header>
    <h1>Estatistik Vant | Rebel Mode</h1>
    <button onclick="location.href='sales.html'">Retounen Lis Vant</button>
  </header>
  <main>
    <div class="stats">
      <div class="card">
        <h2 id="totalSales">0</h2>
        <p>Total Vant</p>
      </div>
      <div class="card">
        <h2 id="totalRevenue">0 Gdes</h2>
        <p>Chiffre d'affaires</p>
      </div>
      <div class="card">
        <h2 id="topProduct">N/A</h2>
        <p>Pwodwi ki vann plis</p>
      </div>
      <div class="card">
        <h2 id="topCategory">N/A</h2>
        <p>Kategori ki vann plis</p>
      </div>
    </div>

    <canvas id="categoryChart" width="400" height="200"></canvas>
  </main>

  <script>
    const sales = JSON.parse(localStorage.getItem('sales') || '[]');

    // Total Vant ak Chiffre d'affaires
    const totalSales = sales.length;
    const totalRevenue = sales.reduce((acc,s)=> acc + s.total, 0);
    document.getElementById('totalSales').textContent = totalSales;
    document.getElementById('totalRevenue').textContent = totalRevenue + " Gdes";

    // Top Pwodwi
    const productCounts = {};
    sales.forEach(s => {
      productCounts[s.product] = (productCounts[s.product] || 0) + s.quantity;
    });
    const topProduct = Object.entries(productCounts).sort((a,b)=>b[1]-a[1])[0];
    document.getElementById('topProduct').textContent = topProduct ? topProduct[0] + " (" + topProduct[1] + ")" : "N/A";

    // Top Kategori
    const categoryCounts = {};
    sales.forEach(s => {
      categoryCounts[s.category] = (categoryCounts[s.category] || 0) + s.quantity;
    });
    const topCategory = Object.entries(categoryCounts).sort((a,b)=>b[1]-a[1])[0];
    document.getElementById('topCategory').textContent = topCategory ? topCategory[0] + " (" + topCategory[1] + ")" : "N/A";

    // Grafik kategori
    const ctx = document.getElementById('categoryChart').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: Object.keys(categoryCounts),
        datasets: [{
          label: 'Vant pa kategori',
          data: Object.values(categoryCounts),
          backgroundColor: '#ffcc00'
        }]
      },
      options: {
        responsive:true,
        scales:{
          y:{ beginAtZero:true, ticks:{ color:'#fff' } },
          x:{ ticks:{ color:'#fff' } }
        },
        plugins:{ legend:{ labels:{ color:'#fff' } } }
      }
    });
  </script>
</body>
</html>